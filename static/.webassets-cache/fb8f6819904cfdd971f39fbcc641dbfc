Vvar Navigation,\u000a  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\u000a\u000aNavigation = (function() {\u000a  function Navigation() {\u000a    this.onAncreClick = __bind(this.onAncreClick, this);\u000a    this.toggleHeaderStyle = __bind(this.toggleHeaderStyle, this);\u000a    this.showIframe = __bind(this.showIframe, this);\u000a    this.showImage = __bind(this.showImage, this);\u000a    this.onScroll = __bind(this.onScroll, this);\u000a    this.relayout = __bind(this.relayout, this);\u000a    var activeTarget, image, lazy_relayout;\u000a    this.uis = {\u000a      brand: $(".navbar-brand"),\u000a      header: $(".header"),\u000a      header_chapters: $(".header .chapters"),\u000a      title: $(".main_title"),\u000a      title_body: $(".main_title .lead"),\u000a      logo_intro: $("img.logo"),\u000a      media: $(".illustration, .iframe"),\u000a      iframes: $(".iframe")\u000a    };\u000a    this.media = {};\u000a    this.titlesOffset = [];\u000a    activeTarget = void 0;\u000a    this.relayout();\u000a    image = $("<img/>").attr("src", this.uis.title.data("src"));\u000a    image.load(this.showImage(this.uis.title));\u000a    lazy_relayout = _.debounce(this.relayout, 10);\u000a    $(window).resize(lazy_relayout);\u000a    window.onscroll = this.onScroll;\u000a    $('.bookmark a, .navbar-header a').click(this.onAncreClick);\u000a    $('.navbar-collapse').on('show.bs.collapse', (function(_this) {\u000a      return function() {\u000a        return _this.toggleHeaderStyle(false);\u000a      };\u000a    })(this));\u000a    $('.navbar-collapse').on('hidden.bs.collapse', (function(_this) {\u000a      return function() {\u000a        return _this.toggleHeaderStyle($(document).scrollTop() === 0);\u000a      };\u000a    })(this));\u000a  }\u000a\u000a  Navigation.prototype.relayout = function() {\u000a    var main_page_height, that, title_body_offset;\u000a    main_page_height = $(window).height() - this.uis.title.offset().top;\u000a    this.uis.title.css('height', main_page_height);\u000a    title_body_offset = main_page_height - this.uis.title_body.height() - 50;\u000a    this.uis.title_body.css({\u000a      top: main_page_height / 2 > title_body_offset ? title_body_offset : ""\u000a    });\u000a    if (this._width === $(window).width()) {\u000a      return false;\u000a    }\u000a    this._width = $(window).width();\u000a    that = this;\u000a    this.uis.iframes.each(function() {\u000a      return $(this).css("height", $(this).width() / parseFloat($(this).data("ratio")));\u000a    });\u000a    this.uis.media.each(function() {\u000a      return $(this).css("height", $(this).width() / parseFloat($(this).data("ratio")));\u000a    });\u000a    this.media = {};\u000a    this.titlesOffset = [];\u000a    $('body').scrollspy({\u000a      target: '.bookmark',\u000a      offset: 300\u000a    });\u000a    return this.uis.media.each(function(e, i) {\u000a      return that.media[$(this).offset().top] = $(this);\u000a    });\u000a  };\u000a\u000a  Navigation.prototype.onScroll = function() {\u000a    var iframe, image, media, offset, window_position, _ref, _results;\u000a    this.toggleHeaderStyle($(document).scrollTop() === 0);\u000a    window_position = $(document).scrollTop() + $(window).height();\u000a    _ref = this.media;\u000a    _results = [];\u000a    for (offset in _ref) {\u000a      media = _ref[offset];\u000a      if (window_position + 300 >= offset) {\u000a        if (media.hasClass("illustration")) {\u000a          image = $("<img />").attr("src", media.data("src"));\u000a          image.load(this.showImage(media, image));\u000a        } else {\u000a          iframe = $("<iframe></iframe>").attr("src", media.data("src")).attr("frameborder", 0).attr("width", "100%").attr("height", "100%");\u000a          media.html(iframe);\u000a          iframe.load(this.showIframe(media, iframe));\u000a        }\u000a        _results.push(delete this.media[offset]);\u000a      } else {\u000a        _results.push(void 0);\u000a      }\u000a    }\u000a    return _results;\u000a  };\u000a\u000a  Navigation.prototype.showImage = function(media, image) {\u000a    var body, loader;\u000a    media.addClass("loading");\u000a    loader = $("<div class=\u005c"loader\u005c"/>");\u000a    media.prepend(loader);\u000a    body = $("<div/>").addClass("body");\u000a    if (media.data("src") != null) {\u000a      media.find(".body").remove();\u000a      media.prepend(body);\u000a    }\u000a    if (media.data("position") != null) {\u000a      body.css({\u000a        "background-position": media.data("position")\u000a      });\u000a    }\u000a    return function(e) {\u000a      if (media.data("src") != null) {\u000a        body.css({\u000a          "background-image": "url(" + (media.data("src")) + ")"\u000a        });\u000a      }\u000a      setTimeout(function() {\u000a        media.removeClass("loading");\u000a        return setTimeout(function() {\u000a          return loader.remove();\u000a        }, 500);\u000a      }, 100);\u000a      return $('body').each(function() {\u000a        var $spy;\u000a        return $spy = $(this).scrollspy('refresh');\u000a      });\u000a    };\u000a  };\u000a\u000a  Navigation.prototype.showIframe = function(media, iframe) {\u000a    var loader;\u000a    loader = $("<div class=\u005c"loader\u005c"/>");\u000a    media.prepend(loader);\u000a    media.addClass("loading");\u000a    return function(e) {\u000a      media.removeClass("loading");\u000a      setTimeout(function() {\u000a        return loader.remove();\u000a      }, 500);\u000a      return $('body').each(function() {\u000a        var $spy;\u000a        return $spy = $(this).scrollspy('refresh');\u000a      });\u000a    };\u000a  };\u000a\u000a  Navigation.prototype.toggleHeaderStyle = function(reverse) {\u000a    if (reverse) {\u000a      this.uis.brand.find("span").addClass("hidden");\u000a      return this.uis.header.addClass("reverse");\u000a    } else {\u000a      this.uis.brand.find("span").removeClass("hidden");\u000a      return this.uis.header.removeClass("reverse");\u000a    }\u000a  };\u000a\u000a  Navigation.prototype.onAncreClick = function(e) {\u000a    var ancre, id, offset;\u000a    ancre = $(e.currentTarget);\u000a    id = ancre.attr("href");\u000a    offset = $(id).offset() ? $(id).offset().top - this.uis.header.outerHeight() : 0;\u000a    $('html, body').animate({\u000a      scrollTop: offset\u000a    }, 'slow');\u000a    return false;\u000a  };\u000a\u000a  return Navigation;\u000a\u000a})();\u000a
p1
.